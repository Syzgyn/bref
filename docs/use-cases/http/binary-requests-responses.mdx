import { Callout } from 'nextra/components';

# Binary requests and responses

AWS Lambda is only used for executing code. Serving assets via PHP does not make sense as this would be a waste of resources and money.

<Callout>
    Deploying a website with assets (e.g. CSS, JavaScript, images) is covered in [the "Websites" documentation](./websites.md).
</Callout>

In some cases however, you want to serve images (or other assets) via PHP. One example would be if you served generated images or PDFs via PHP.

By default, AWS Lambda **does not support binary HTTP requests or responses** like images, PDF, binary filesâ€¦ To achieve this, you need to set the `BREF_BINARY_RESPONSES` environment variable in `serverless.yml`:

```yml filename="serverless.yml" {3-4}
provider:
    # ...
    environment:
        BREF_BINARY_RESPONSES: '1'
```

This will make AWS Lambda support binary file uploads and downloads, and Bref will automatically encode responses to base64 (which is what Lambda expects for binary responses).

Be aware that the max upload and download size is **6MB**. For larger files, use AWS S3. An example is available in [Serverless Visually Explained](https://serverless-visually-explained.com/).

## With API Gateway

If you use API Gateway (`httpApi` events) instead of Lambda Function URL (the `url: true` option), you also need to enable binary media types in `serverless.yml`:

```yml filename="serverless.yml" {5-7}
provider:
    # ...
    environment:
        BREF_BINARY_RESPONSES: '1'
    apiGateway:
        binaryMediaTypes:
            - '*/*'
```
